import React,{useEffect,useState,useRef} from 'react';import { load, save } from '../utils/storage';import { useNavigate } from 'react-router-dom';export default function StudentExam(){const nav=useNavigate();const db=load();const exam=db.exams[0];const [answers,setAnswers]=useState({});const [timeLeft,setTimeLeft]=useState(exam.durationMinutes*60);const timerRef=useRef();useEffect(()=>{timerRef.current=setInterval(()=>setTimeLeft(t=>{if(t<=1){clearInterval(timerRef.current);handleSubmit();return 0;}return t-1}),1000);return ()=>clearInterval(timerRef.current);},[]);function pick(i,val){setAnswers(a=>({...a,[i]:val}));}function handleSubmit(){const user=JSON.parse(localStorage.getItem('gwpss_user')||'{}');const reg=user?.reg||'GWPS001';const data={mcq:answers,written:{}};const full=load();const student=full.students.find(s=>s.reg===reg);student.results=student.results||{};student.results[exam.id]=data;save(full);alert('Submitted');localStorage.removeItem('gwpss_user');nav('/');}return (<div className='container'><div className='card'><h3>{exam.title}</h3><p>Time left: {Math.floor(timeLeft/60)}:{String(timeLeft%60).padStart(2,'0')}</p>{exam.mcqs.map((q,idx)=>(<div key={idx}><p>{idx+1}. {q.q}</p>{q.options.map((opt,i)=>(<button key={i} onClick={()=>pick(idx,i)} style={{marginRight:6}}>{opt}</button>))}</div>))}<div style={{marginTop:12}}><button onClick={handleSubmit}>Submit Now</button></div></div></div>); }